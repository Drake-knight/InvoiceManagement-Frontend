var Fe=Object.defineProperty,ke=Object.defineProperties;var Le=Object.getOwnPropertyDescriptors;var H=Object.getOwnPropertySymbols;var ne=Object.prototype.hasOwnProperty,ie=Object.prototype.propertyIsEnumerable;var se=(n,i,a)=>i in n?Fe(n,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[i]=a,w=(n,i)=>{for(var a in i||(i={}))ne.call(i,a)&&se(n,a,i[a]);if(H)for(var a of H(i))ie.call(i,a)&&se(n,a,i[a]);return n},C=(n,i)=>ke(n,Le(i));var ae=(n,i)=>{var a={};for(var o in n)ne.call(n,o)&&i.indexOf(o)<0&&(a[o]=n[o]);if(n!=null&&H)for(var o of H(n))i.indexOf(o)<0&&ie.call(n,o)&&(a[o]=n[o]);return a};import{a as Ee,F as r,r as y,j as e,M as A,b as t,I,D as le,c as J,S as $,d as qe,B as v,P as Te,e as Ae,f as Be,g as De,V as S,T as F,h as oe,i as K,k as Me,l as Ne,L as M,u as X,m as Oe,n as N,o as ce,p as de,K as Z,C as $e,R as B,q as me,s as ee,t as te,v as ue,w as T,x as he,G as je,y as ze,z as Re,A as j,E as pe,H as Ve}from"./vendor.a9590274.js";const Ue=function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))o(c);new MutationObserver(c=>{for(const s of c)if(s.type==="childList")for(const d of s.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function a(c){const s={};return c.integrity&&(s.integrity=c.integrity),c.referrerpolicy&&(s.referrerPolicy=c.referrerpolicy),c.crossorigin==="use-credentials"?s.credentials="include":c.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(c){if(c.ep)return;c.ep=!0;const s=a(c);fetch(c.href,s)}};Ue();const He="/",Ke="http://localhost:5100",_=Ee.create({baseURL:`${Ke}${He}`,withCredentials:!0}),Qe=({visible:n,onCreate:i,onCancel:a})=>{const[o]=r.useForm(),[c,s]=y.exports.useState([{item_name:"",quantity:"",price:""}]),[d,b]=y.exports.useState("");return y.exports.useEffect(()=>{const x=localStorage.getItem("user_id");x&&b(x)},[]),e(A,{visible:n,title:"Add New Invoice",okText:"Add",cancelText:"Cancel",onCancel:a,onOk:()=>{o.validateFields().then(x=>{i(C(w({},x),{userId:d})),o.resetFields(),s([])})},destroyOnClose:!0,children:t(r,{form:o,layout:"vertical",children:[e(r.Item,{name:"customer_name",label:"Customer Name",rules:[{required:!0,message:"Please enter customer name"}],children:e(I,{})}),e(r.Item,{name:"customer_email",label:"Customer Email",rules:[{required:!0,message:"Please enter customer email"},{type:"email",message:"Please enter a valid email address"}],children:e(I,{})}),e(r.Item,{name:"customer_phone",label:"Customer Phone",rules:[{required:!0,message:"Please enter customer phone"},{pattern:/^[0-9]{10}$/,message:"Please enter a 10-digit phone number"}],children:e(I,{})}),e(r.Item,{name:"date",label:"Invoice Date",rules:[{required:!0,message:"Please select invoice date"}],children:e(le,{style:{width:"100%"}})}),e(r.List,{name:"line_items",children:(x,{add:k,remove:p})=>t(J,{children:[x.map((W,Q)=>{var D=W,{key:f,name:L,fieldKey:E}=D,q=ae(D,["key","name","fieldKey"]);return t($,{style:{display:"flex",marginBottom:8},align:"baseline",children:[e(r.Item,C(w({},q),{name:[L,"item_name"],fieldKey:[E,"item_name"],rules:[{required:!0,message:"Missing item name"}],children:e(I,{placeholder:"Item Name"})})),e(r.Item,C(w({},q),{name:[L,"quantity"],fieldKey:[E,"quantity"],rules:[{required:!0,message:"Missing quantity"}],children:e(I,{placeholder:"Quantity(number)",style:{width:100}})})),e(r.Item,C(w({},q),{name:[L,"price"],fieldKey:[E,"price"],rules:[{required:!0,message:"Missing price"}],children:e(I,{placeholder:"Price (\u20B9)",style:{width:100}})})),e(qe,{onClick:()=>p(L)})]},f)}),e(r.Item,{children:e(v,{type:"dashed",onClick:()=>k(),block:!0,icon:e(Te,{}),children:"Add Line Item"})})]})})]})})},h=Ae.create({page:{flexDirection:"column",backgroundColor:"#FFF",padding:"5%"},header:{marginBottom:"5%",textAlign:"center"},headerText:{fontSize:24,fontWeight:"bold",marginBottom:"2%"},separator:{borderBottomWidth:2,borderBottomColor:"#000",marginBottom:"5%"},section:{marginBottom:"5%"},sectionTitle:{fontWeight:"bold",marginBottom:"2%"},customerInfo:{marginBottom:"5%"},customerInfoItem:{marginBottom:"2%"},table:{display:"table",width:"100%",borderStyle:"solid",borderWidth:1,borderColor:"#000",marginBottom:10},tableRow:{flexDirection:"row"},tableCol:{width:"33.33%",borderStyle:"solid",borderWidth:1,borderColor:"#000",padding:5},tableHeader:{backgroundColor:"#f2f2f2"},tableCell:{fontSize:10}}),We=({record:n})=>e(Be,{children:t(De,{size:"A4",style:h.page,children:[t(S,{style:h.header,children:[e(F,{style:h.headerText,children:"Invoice"}),e(S,{style:h.separator})]}),t(S,{style:h.section,children:[e(F,{style:h.sectionTitle,children:"Customer Details:"}),t(S,{style:h.customerInfo,children:[t(F,{style:h.customerInfoItem,children:["Name: ",n.customer_name]}),t(F,{style:h.customerInfoItem,children:["Phone: ",n.customer_phone]}),t(F,{style:h.customerInfoItem,children:["Email: ",n.customer_email]})]})]}),t(S,{style:h.table,children:[t(S,{style:[h.tableRow,h.tableHeader],children:[e(S,{style:h.tableCol,children:e(F,{style:h.tableCell,children:"Item Name"})}),e(S,{style:h.tableCol,children:e(F,{style:h.tableCell,children:"Price"})}),e(S,{style:h.tableCol,children:e(F,{style:h.tableCell,children:"Quantity"})})]}),n.line_items.map((i,a)=>t(S,{style:h.tableRow,children:[e(S,{style:h.tableCol,children:e(F,{style:h.tableCell,children:i.item_name})}),e(S,{style:h.tableCol,children:e(F,{style:h.tableCell,children:i.price})}),e(S,{style:h.tableCol,children:e(F,{style:h.tableCell,children:i.quantity})})]},a))]})]})}),Ge=({data:n,handleDelete:i,handleUpdateInvoice:a,handleRemoveLine:o,handleAddLine:c,handleUpdateLine:s})=>{const[d,b]=y.exports.useState(!1),[P,x]=y.exports.useState(!1),[k,p]=y.exports.useState(!1),[f,L]=y.exports.useState(!1),[E,q]=y.exports.useState([]),[Q,W]=y.exports.useState({}),[D,G]=y.exports.useState(null),[z]=r.useForm(),[m]=r.useForm(),[g]=r.useForm(),[O,Y]=y.exports.useState(null),R=[{title:"Invoice ID",dataIndex:"invoice_id"},{title:"Date",dataIndex:"invoice_date"},{title:"Customer Name",dataIndex:"customer_name"},{title:"Customer Email",dataIndex:"customer_email"},{title:"Customer Phone",dataIndex:"customer_phone"},{title:"Actions",render:(l,u)=>t($,{children:[e(v,{onClick:()=>fe(u),children:"Delete Invoice"}),e(v,{onClick:()=>Ie(u),children:"Edit Invoice"}),e(v,{onClick:()=>be(u),children:"View Line Items"})]})},{title:"Action",render:(l,u)=>e(Me,{document:e(We,{record:u}),fileName:`invoice_${u.invoice_id}.pdf`,children:({blob:V,url:U,loading:_e,error:ct})=>_e?"Loading document...":"Download Invoice"})}],ye=[{title:"Item Name",dataIndex:"item_name"},{title:"Quantity",dataIndex:"quantity"},{title:"Price",dataIndex:"price"},{title:"Actions",render:(l,u)=>t($,{children:[e(v,{onClick:()=>we(u),children:"Edit"}),e(v,{onClick:()=>Pe(u),children:"Delete"})]})}],fe=l=>{i(l.invoice_id)},Ie=l=>{z.setFieldsValue({customer_name:l.customer_name,customer_email:l.customer_email,customer_phone:l.customer_phone,date:Ne(l.invoice_date)}),W(l),b(!0)},be=l=>{q(l.line_items),Y(l.invoice_id),x(!0)},ve=()=>{z.validateFields().then(l=>{const u=w(w({},Q),l);u.date&&(u.date=new Date(u.date).toISOString().split("T")[0]),a(u),b(!1)})},we=l=>{g.setFieldsValue({item_name:l.item_name,price:l.price,quantity:l.quantity}),G(l),L(!0)},Ce=()=>{g.validateFields().then(l=>{let u=null;const V=E.map(U=>U===D?(u=C(w({},U),{item_name:l.item_name,price:l.price,quantity:l.quantity}),u):U);q(V),u&&s(u,D.line_item_id),L(!1),g.resetFields(),G(null)})},Pe=l=>{const u=E.filter(V=>V!==l);o(l.line_item_id),q(u)},xe=()=>{p(!0)},Se=()=>{m.validateFields().then(l=>{const u={invoice_id:O,item_name:l.item_name,price:l.price,quantity:l.quantity};q([...E,u]),p(!1),c(u),m.resetFields()})};return t("div",{children:[e(oe,{columns:R,dataSource:n,rowKey:"invoice_id"}),e(A,{title:"Edit Invoice",visible:d,onCancel:()=>b(!1),onOk:ve,children:t(r,{form:z,layout:"vertical",children:[e(r.Item,{name:"customer_name",label:"Customer Name",rules:[{required:!0,message:"Please enter customer name"}],children:e(I,{})}),e(r.Item,{name:"customer_email",label:"Customer Email",rules:[{required:!0,message:"Please enter customer email"},{type:"email",message:"Please enter a valid email address"}],children:e(I,{})}),e(r.Item,{name:"customer_phone",label:"Customer Phone",rules:[{required:!0,message:"Please enter customer phone"},{pattern:/^[0-9]{10}$/,message:"Please enter a 10-digit phone number"}],children:e(I,{})}),e(r.Item,{name:"date",label:"Invoice Date",rules:[{required:!0,message:"Please select invoice date"}],children:e(le,{style:{width:"100%"}})})]})}),e(A,{title:"Line Items",visible:P,onCancel:()=>x(!1),footer:[e(v,{type:"primary",onClick:xe,children:"Add Line Item"},"add"),e(v,{onClick:()=>x(!1),children:"Close"},"close")],children:e(oe,{columns:ye,dataSource:E,pagination:!1,rowKey:(l,u)=>u})}),e(A,{title:"Add Line Item",visible:k,onCancel:()=>p(!1),onOk:Se,children:t(r,{form:m,layout:"vertical",children:[e(r.Item,{name:"item_name",label:"Item Name",rules:[{required:!0,message:"Please enter item name"}],children:e(I,{})}),e(r.Item,{name:"price",label:"Price(\u20B9)",rules:[{required:!0,message:"Please enter item price"}],children:e(K,{placeholder:"Price (\u20B9)",min:0})}),e(r.Item,{name:"quantity",label:"Quantity",rules:[{required:!0,message:"Please enter item quantity"}],children:e(K,{placeholder:"in number",min:0})})]})}),e(A,{title:"Edit Line Item",visible:f,onCancel:()=>L(!1),onOk:Ce,children:t(r,{form:g,layout:"vertical",children:[" ",e(r.Item,{name:"item_name",label:"Item Name",rules:[{required:!0,message:"Please enter item name"}],children:e(I,{})}),e(r.Item,{name:"price",label:"Price(\u20B9)",rules:[{required:!0,message:"Please enter item price"}],children:e(K,{placeholder:"Price (\u20B9)",min:0})}),e(r.Item,{name:"quantity",label:"Quantity",rules:[{required:!0,message:"Please enter item quantity"}],children:e(K,{placeholder:"in number",min:0})})]})})]})},{Footer:Ye}=M,Je=()=>t(Ye,{style:{textAlign:"center"},children:["Invoice Manager Created by"," ",e("a",{href:"#",onClick:()=>{window.open("https://github.com/Drake-knight","_blank")},children:"Vishal"})]}),{Header:Xe,Content:Ze}=M,{Title:ge}=N,et=()=>{const[n,i]=y.exports.useState([]),[a,o]=y.exports.useState(!1),[c,s]=y.exports.useState(!1),[d,b]=y.exports.useState(""),[P,x]=y.exports.useState(""),k=X();y.exports.useEffect(()=>{const m=localStorage.getItem("user_id");m&&x(m)},[]);const p=m=>{m.response&&m.response.status===401&&k.push("/login")};y.exports.useEffect(()=>{const m=localStorage.getItem("jwtToken");m&&b(m)},[]),y.exports.useEffect(()=>{P&&f(P)},[P]);const f=async m=>{try{o(!0);const Y=(await _.get(`/invoices/${m}`,{headers:{Authorization:`Bearer ${d}`}})).data.map(R=>C(w({},R),{invoice_date:new Date(R.invoice_date).toISOString().split("T")[0]}));i(Y)}catch(g){p(g),console.error("Error fetching data:",g)}finally{o(!1)}};return t(M,{className:"layout",children:[t(Xe,{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e("div",{children:e(ge,{level:3,style:{color:"white",margin:0},children:"Invoice"})}),t("div",{children:[e(v,{type:"primary",onClick:()=>s(!0),style:{marginLeft:"10px"},children:"Add Invoice"}),e(v,{type:"primary",onClick:async()=>{try{await _.get("/logout",{headers:{Authorization:`Bearer ${d}`}}),localStorage.removeItem("jwtToken"),localStorage.removeItem("user_id"),k.push("/login")}catch(m){console.error("Error logging out:",m)}},style:{marginLeft:"10px"},children:"Logout"})]})]}),e(Ze,{style:{padding:"0 50px"},children:t("div",{className:"site-layout-content",children:[e("div",{style:{marginBottom:"20px",display:"flex",justifyContent:"space-between"},children:e(ge,{level:2,children:"Invoices"})}),e(Qe,{visible:c,setVisible:s,onCreate:async m=>{try{await _.post("/invoices",m,{headers:{Authorization:`Bearer ${d}`}}),f(P),s(!1)}catch(g){p(g),console.error("Error adding invoice:",g)}},fetchData:f,onCancel:()=>{s(!1)}}),a?e(Oe,{size:"large"}):e(Ge,{data:n,handleDelete:async m=>{try{await _.delete(`/invoices/${m}`,{headers:{Authorization:`Bearer ${d}`}}),f(P)}catch(g){p(g),console.error("Error deleting invoice:",g)}},handleUpdateInvoice:async m=>{try{await _.put(`/invoices/${m.invoice_id}`,m,{headers:{Authorization:`Bearer ${d}`}}),f(P),s(!1)}catch(g){p(g),console.error("Error adding invoice:",g)}},handleRemoveLine:async m=>{try{await _.delete(`/line-items/${m}`,{headers:{Authorization:`Bearer ${d}`}}),f(P)}catch(g){p(g),console.error("Error deleting invoice:",g)}},handleAddLine:async m=>{try{await _.post("/line-items",m,{headers:{Authorization:`Bearer ${d}`}}),f(P),s(!1)}catch(g){p(g),console.error("Error adding invoice:",g)}},handleUpdateLine:async(m,g)=>{try{await _.put(`/line-items/${g}`,m,{headers:{Authorization:`Bearer ${d}`}}),f(P),s(!1)}catch(O){p(O),console.error("Error adding invoice:",O)}}})]})}),e(Je,{})]})},{Step:re}=ce,tt=({visible:n,setVisible:i})=>{const[a,o]=y.exports.useState(0),[c,s]=y.exports.useState({onEmailFinish:!1,onPasswordFinish:!1}),[d,b]=y.exports.useState("");return t(A,{visible:n,closable:!1,footer:null,destroyOnClose:!0,children:[t(ce,{current:a,children:[e(re,{icon:e(de,{})}),e(re,{icon:e(Z,{})}),e(re,{icon:e($e,{})})]}),a===0?t(r,{name:"forgotPasswordModal",onFinish:async k=>{try{s(f=>C(w({},f),{onEmailFinish:!0}));const{data:p}=await _.post("/pw-reset-mail",k);console.log(p),s(f=>C(w({},f),{onEmailFinish:!1})),b(p.email),console.log(p.email),o(1),console.log("Email sent successfully"),console.log(a)}catch(p){s(f=>C(w({},f),{onEmailFinish:!1})),console.log(p)}},preserve:!1,layout:"vertical",validateTrigger:"onSubmit",children:[e(r.Item,{name:"email",label:"Enter the corresponding Email",rules:[{required:!0,message:"Please enter your Email"},{type:"email",message:"The input is not a valid Email"}],children:e(I,{})}),e(B,{justify:"end",children:t($,{children:[e(v,{onClick:()=>i(!1),children:"Cancel"}),e(r.Item,{style:{marginBottom:"0"},children:e(v,{htmlType:"submit",type:"primary",loading:c.onEmailFinish,children:"Send Password Reset Code"})})]})})]}):a===1?t(r,{name:"forgotPasswordModal",onFinish:async k=>{try{s(p=>C(w({},p),{onPasswordFinish:!0})),await _.post("/reset-password",C(w({},k),{email:d})),s(p=>C(w({},p),{onPasswordFinish:!1})),o(2)}catch(p){s(f=>C(w({},f),{onPasswordFinish:!1})),console.log(p)}},preserve:!1,layout:"vertical",validateTrigger:"onSubmit",children:[e(N.Text,{strong:!0,children:"Check your Mail for reset code."}),e(r.Item,{label:"Insert the reset code here",name:"resetCode",rules:[{required:!0,message:"Please input the required code."}],children:e(I,{})}),e(r.Item,{label:"Your new password",name:"newPassword",rules:[{required:!0,message:"Please input your new password"}],children:e(I.Password,{})}),e(B,{justify:"end",children:t($,{children:[e(v,{onClick:()=>{o(0),i(!1)},children:"Cancel"}),e(r.Item,{style:{marginBottom:"0"},children:e(v,{htmlType:"submit",type:"primary",loading:c.onPasswordFinish,children:"Reset My Password"})})]})})]}):e(me,{icon:e(ee,{}),title:"Password reset successful!",extra:e(v,{type:"primary",onClick:()=>i(!1),children:"Close"})})]})},{useBreakpoint:rt}=je,{Content:nt}=M,it=()=>{const[n,i]=y.exports.useState(!1);rt();const a=X(),[o,c]=y.exports.useState(!1),s=async d=>{try{c(!0);const{data:b}=await _.post("/login",d);localStorage.setItem("jwtToken",b.token),localStorage.setItem("user_id",b.user_id),a.push("/invoice"),c(!1)}catch(b){c(!1),console.error(b)}};return e(J,{children:t(nt,{className:"container",children:[e(tt,{visible:n,setVisible:i,userType:"mentor"}),e(B,{justify:"center"}),t("div",{className:"form",children:[e(te,{children:t(N.Title,{level:3,justify:"center",style:{margin:"unset"},children:[e(ue,{}),"Login"]})}),t(r,{size:"large",layout:"vertical",name:"Login",onFinish:s,children:[e(r.Item,{label:"E-Mail",name:"email",rules:[{required:!0,message:"Please input your E-Mail!"}],children:e(I,{})}),e(r.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please input your password!"}],extra:e(v,{onClick:()=>i(!0),type:"link",style:{paddingLeft:"0"},size:"small",children:"Forgot Password?"}),children:e(I.Password,{})}),t(B,{justify:"space-between",align:"top",children:[t(T,{flex:"auto",children:[e("div",{children:e(N.Text,{type:"secondary",strong:!0,children:"New here?"})}),e(he,{to:"/register",children:"Register here"})]}),e(T,{span:8,style:{textAlign:"right"},children:e(r.Item,{style:{marginBottom:"0px"},children:e(v,{type:"primary",size:"large",htmlType:"submit",loading:o,children:"Log In"})})})]})]})]})]})})},{Content:st}=M,at=()=>{const[n]=r.useForm(),i=X(),[a,o]=y.exports.useState(!1),c=async s=>{try{await n.validateFields(),o(!0);const{data:d}=await _.post("/register",s);o(!1),localStorage.setItem("jwtToken",d.token),localStorage.setItem("user_id",d.user_id);const b=A.success({content:e(me,{icon:e(ee,{}),title:"Yay!",subTitle:"You are successfully registered. ",extra:"Thank you for registering.",style:{overflowY:"hidden"}}),centered:!0,maskClosable:!1,keyboard:!1,okButtonProps:{onClick:()=>{i.push("/invoice"),b.destroy()}},okText:"Done!"})}catch(d){o(!1),console.error("Error",d.message)}};return e(J,{children:e(st,{className:"container",children:t("div",{className:"form",children:[e(te,{children:t(N.Title,{level:3,justify:"center",style:{margin:"unset"},children:[e(ue,{})," Registration Form"]})}),t(r,{form:n,name:"register",onFinish:c,size:"large",layout:"vertical",scrollToFirstError:!0,children:[t(B,{gutter:12,children:[e(T,{xs:24,md:12,children:e(r.Item,{name:"Name",label:t("span",{children:[e(ee,{})," Name"," "]}),rules:[{required:!0,message:"Please enter your name"},{validator:async(s,d)=>{if(!d||!/\s/.test(d.trim()))return!0;throw new Error("Please enter a single word")}}],children:e(I,{})})}),e(T,{xs:24,md:12,children:e(r.Item,{name:"email",label:t("span",{children:[e(de,{})," Email"," "]}),rules:[{type:"email",message:"The input is not valid Email!"},{required:!0,message:"Please input your Email!"}],children:e(I,{})})})]}),t(B,{gutter:12,children:[e(T,{xs:24,md:12,children:e(r.Item,{name:"password",rules:[{required:!0,message:"Please input your password."},{min:6,message:"Please input at least 6 characters."}],label:t("span",{children:[e(Z,{})," Create Password"]}),children:e(I.Password,{})})}),e(T,{xs:24,md:12,children:e(r.Item,{dependencies:["password"],name:"confirmPassword",hasFeedback:!0,validateTrigger:"onChange",rules:[{required:!0,message:"Please confirm your password."},({getFieldValue:s})=>({validator(d,b){return!b||s("password")===b?Promise.resolve():Promise.reject("Please enter the same password")}})],label:t("span",{children:[e(Z,{})," Confirm Password"]}),children:e(I.Password,{})})})]}),e(te,{}),t(B,{gutter:12,justify:"space-between",align:"top",children:[t(T,{flex:"auto",children:[e("div",{children:e(N.Text,{type:"secondary",strong:!0,children:"Already registered"})}),e(he,{to:"/login",children:"Log In"})]}),e(T,{span:{lg:8,xs:12},children:e(r.Item,{children:e(v,{style:{width:"100%"},type:"primary",size:"large",htmlType:"submit",loading:a,children:"Submit"})})})]})]})]})})})},lt=()=>localStorage.getItem("jwtToken");function ot(){return e(M,{id:"app",children:e(ze,{basename:"/",children:t(Re,{children:[e(j,{exact:!0,path:"/register",component:at}),e(j,{exact:!0,path:"/login",component:it}),e(j,{path:"/invoice",render:()=>lt()?e(j,{exact:!0,path:"/invoice",component:et}):e(pe,{to:"/login"})}),e(j,{path:"*",children:e(pe,{to:"/login"})})]})})})}Ve.render(e(ot,{}),document.getElementById("root"));
